import{a6 as I,a7 as L,n as m,a8 as N,a9 as _}from"./index.c94220ca.js";import{t as S}from"./throttle.2c770a80.js";const l="ElInfiniteScroll",w=50,A=200,O=0,C={delay:{type:Number,default:A},distance:{type:Number,default:O},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},E=(t,n)=>Object.entries(C).reduce((o,[e,s])=>{var u,i;const{type:d,default:r}=s,a=t.getAttribute(`infinite-scroll-${e}`);let c=(i=(u=n[a])!=null?u:a)!=null?i:r;return c=c==="false"?!1:c,c=d(c),o[e]=Number.isNaN(c)?r:c,o},{}),g=t=>{const{observer:n}=t[l];n&&(n.disconnect(),delete t[l].observer)},D=(t,n)=>{const{container:o,containerEl:e,instance:s,observer:u,lastScrollTop:i}=t[l],{disabled:d,distance:r}=E(t,s),{clientHeight:a,scrollHeight:c,scrollTop:f}=e,h=f-i;if(t[l].lastScrollTop=f,u||d||h<0)return;let b=!1;if(o===t)b=c-(a+f)<=r;else{const{clientTop:T,scrollHeight:y}=t,H=_(t,e);b=f+a>=H+T+y-r}b&&n.call(s)};function v(t,n){const{containerEl:o,instance:e}=t[l],{disabled:s}=E(t,e);s||o.clientHeight===0||(o.scrollHeight<=o.clientHeight?n.call(e):g(t))}const F={async mounted(t,n){const{instance:o,value:e}=n;I(e)||L(l,"'v-infinite-scroll' binding value must be a function"),await m();const{delay:s,immediate:u}=E(t,o),i=N(t,!0),d=i===window?document.documentElement:i,r=S(D.bind(null,t,e),s);if(!!i){if(t[l]={instance:o,container:i,containerEl:d,delay:s,cb:e,onScroll:r,lastScrollTop:d.scrollTop},u){const a=new MutationObserver(S(v.bind(null,t,e),w));t[l].observer=a,a.observe(t,{childList:!0,subtree:!0}),v(t,e)}i.addEventListener("scroll",r)}},unmounted(t){const{container:n,onScroll:o}=t[l];n==null||n.removeEventListener("scroll",o),g(t)},async updated(t){t[l]||await m();const{containerEl:n,cb:o,observer:e}=t[l];n.clientHeight&&e&&v(t,o)}},p=F;p.install=t=>{t.directive("InfiniteScroll",p)};const x=p;export{x as E};
