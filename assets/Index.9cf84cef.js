import{Q as T,a4 as q,W as B,a2 as M,r as V,o as z,aa as E,I as U,S as R,i as w,k as m,l as s,x as p,q as _,X as d,D as l,F as D,C,z as h,t as $,j as r,m as L,K as F,U as P,V as j}from"./index.c94220ca.js";import{C as K}from"./Comments.dd0102b8.js";const Q={name:"albumDetail",components:{SongList:q,CommentList:K},setup(e){const{proxy:a}=F(),g=B(),c=M(),t=V({albumId:"",details:null,songList:[],dynamic:{},hotAlbums:[],comments:[],type:3,isShowDesc:!1,collects:[]}),I=async i=>{const{data:n}=await a.$http.album(i);if(n.code!==200)return a.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");t.details=n.album;const k=[];n.songs.forEach(N=>{k.push(N.privilege)}),t.songList=a.$utils.formatSongs(n.songs,k),u()},b=async i=>{const{data:n}=await a.$http.albumDynamic(i);if(n.code!==200)return a.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");t.dynamic=n},u=async()=>{const{data:i}=await a.$http.artistAlbum({id:t.details.artists[0].id,limit:5});if(i.code!==200)return a.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");t.hotAlbums=i.hotAlbums},f=()=>{t.details.description.length>120&&(t.isShowDesc=!t.isShowDesc)},v=()=>{g.dispatch("playAll",{list:t.songList}),g.commit("SET_PLAYLISTTIPS",!0)},o=async()=>{const{data:i}=await a.$http.albumSub({id:t.albumId,t:Number(!t.dynamic.isSub)});if(i.code!==200)return a.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");t.dynamic.isSub=Number(!t.dynamic.isSub)},S=async i=>{const{data:n}=await a.$http.playlistSCollect(i);if(n.code!==200)return a.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");t.collects=n.subscribers},A=()=>{I({id:t.albumId}),b({id:t.albumId}),S({id:t.albumId})};return z(()=>{t.albumId=c.query.id,A()}),E(i=>{t.albumId=i.query.id,A()}),{...U(t),showAllDesc:f,playAllSongs:v,subAlbum:o}}},y=e=>(P("data-v-1f453460"),e=e(),j(),e),W={key:0,class:"album"},X={class:"detail-container"},Y={class:"detail-main"},G={class:"album-cover"},H={class:"album-img"},J=y(()=>s("div",{slot:"placeholder",class:"image-slot"},[s("i",{class:"iconfont icon-placeholder"})],-1)),O={class:"album-info"},Z={class:"album-title"},x={class:"album-singer"},ss={class:"album-time"},es={class:"album-company"},ts={key:0,class:"album-desc"},as=y(()=>s("i",{class:"iconfont icon-closed"},null,-1)),os=[as],is={key:0,class:"album-desc-all"},ls={class:"song-main"},ns={class:"song-header"},ds=y(()=>s("i",{class:"iconfont icon-audio-play"},null,-1)),cs={class:"album-comments",ref:"comment"},rs={class:"aside-box"},ms={class:"album-aside album-other"},us={class:"aside-title"},ps={class:"aside-main aside-album-main"},_s=y(()=>s("div",{slot:"placeholder",class:"image-slot"},[s("i",{class:"iconfont icon-placeholder"})],-1)),bs={class:"aside-album-info"},hs={class:"aside-album-name"},ys={class:"aside-album-time"};function gs(e,a,g,c,t,I){const b=R,u=w("router-link"),f=q,v=w("comment-list");return e.details?(r(),m("div",W,[s("div",X,[s("div",Y,[s("div",G,[s("div",H,[p(b,{src:e.details.picUrl},{default:_(()=>[J]),_:1},8,["src"])]),s("div",O,[s("div",Z,[d(l(e.details.name)+" ",1),s("span",null,l("#"+e.details.type),1)]),s("div",x,[d("\u6B4C\u624B\uFF1A"),(r(!0),m(D,null,C(e.details.artists,(o,S)=>(r(),L(u,{to:{path:"/singer",query:{id:o.id}},class:"song_name",key:o.name},{default:_(()=>[d(l(S!==0?" / "+o.name:o.name),1)]),_:2},1032,["to"]))),128))]),s("div",ss,"\u53D1\u884C\u65F6\u95F4\uFF1A"+l(e.$utils.formartDate(e.details.publishTime,"yyyy-MM-dd")),1),s("div",es,"\u53D1\u884C\u516C\u53F8\uFF1A"+l(e.details.company),1),e.details.description?(r(),m("div",ts,[s("h5",null,[d("\u6B4C\u5355\u7B80\u4ECB"),e.isShowDesc?(r(),m("em",{key:0,class:"desc-close",onClick:a[0]||(a[0]=o=>e.isShowDesc=!1)},os)):h("",!0)]),s("p",{onClick:a[1]||(a[1]=(...o)=>c.showAllDesc&&c.showAllDesc(...o))},l(e.details.description),1),e.isShowDesc?(r(),m("pre",is,"                                "+l(e.details.description)+`
                            `,1)):h("",!0)])):h("",!0)])]),s("div",ls,[s("div",ns,[s("h4",null,[d("\u5305\u542B\u6B4C\u66F2\u5217\u8868 "),s("em",null,l(e.details.size+"\u9996\u6B4C"),1)]),s("span",{class:"play-all",onClick:a[2]||(a[2]=(...o)=>c.playAllSongs&&c.playAllSongs(...o))},[ds,d(" \u64AD\u653E\u5168\u90E8")]),s("span",{class:$(["collect",e.dynamic.isSub?"active":""]),onClick:a[3]||(a[3]=(...o)=>c.subAlbum&&c.subAlbum(...o))},[s("i",{class:$(["iconfont","icon-collect"+(e.dynamic.isSub?"-active":"")])},null,2),d(" "+l(e.dynamic.isSub?"\u5DF2\u6536\u85CF":"\u6536\u85CF"),1)],2)]),p(f,{songList:e.songList,stripe:!0},null,8,["songList"])]),s("div",cs,[p(v,{type:e.type,sId:e.albumId},null,8,["type","sId"])],512)]),s("div",rs,[s("div",ms,[s("h3",us,[d(l(e.details.artists[0].name)+"\u7684\u5176\u4ED6\u4E13\u8F91",1),p(u,{to:{path:"/singer",query:{id:e.details.artists[0].id,type:"album"}},class:"album-more"},{default:_(()=>[d("\u5168\u90E8>>")]),_:1},8,["to"])]),s("div",ps,[(r(!0),m(D,null,C(e.hotAlbums,o=>(r(),L(u,{class:"aside-album-item",to:{path:"/album",query:{id:o.id}},key:o.id},{default:_(()=>[p(b,{src:o.picUrl},{default:_(()=>[_s]),_:2},1032,["src"]),s("div",bs,[s("div",hs,l(o.name),1),s("div",ys,l(e.$utils.formartDate(e.details.publishTime,"yyyy-MM-dd")),1)])]),_:2},1032,["to"]))),128))])])])])])):h("",!0)}var Ss=T(Q,[["render",gs],["__scopeId","data-v-1f453460"]]);export{Ss as default};
