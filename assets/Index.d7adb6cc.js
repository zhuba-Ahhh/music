import{Q as C,a2 as S,R as $,W as b,r as D,o as F,a3 as M,I as N,a4 as T,S as O,k as m,l as s,x as y,q as I,X as d,D as i,z as q,t as p,m as k,F as w,C as A,j as _,K as R,U as V,V as B}from"./index.c94220ca.js";import{_ as L}from"./Loading.15072aef.js";const E={name:"Rank",setup(){const{proxy:t}=R(),n=S(),v=$(),r=b(),o=D({list:[],type:"Top",listTop:[],listFeature:[],listOther:[],rId:0,rankInfo:{},songList:[],total:0,isLoading:!0}),g=async()=>{const{data:e}=await t.$http.topListDetail();if(e.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");o.listTop=e.list.filter(c=>c.ToplistType),o.listFeature=e.list.filter(c=>!c.ToplistType&&c.name.indexOf("\u4E91\u97F3\u4E50")>=0),o.listOther=e.list.filter(c=>!c.ToplistType&&c.name.indexOf("\u4E91\u97F3\u4E50")<0),o.list=o.type?o["list"+o.type]:o.listTop,o.rId=o.rId?o.rId:o.listTop[0].id},u=async()=>{o.isLoading=!0;const{data:e}=await t.$http.listDetail({id:o.rId,s:-1});if(e.code!==200)return t.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");o.rankInfo=e.playlist,o.songList=t.$utils.formatSongs(e.playlist.tracks,e.privileges),o.total=o.songList.length,o.isLoading=!1},h=e=>{o.type=e,o.list=o["list"+o.type],o.rId=o["list"+e][0].id,v.push({path:"rank",query:{type:o.type,rId:o.rId}})},f=e=>{o.rId=e.id,v.push({path:"rank",query:{type:o.type,rId:o.rId}})},a=()=>{r.dispatch("playAll",{list:o.songList}),r.commit("SET_PLAYLISTTIPS",!0)};return F(()=>{o.type=n.query.type||o.type,o.rId=n.query.rId,g()}),M(()=>{o.rId&&u()}),{...N(o),selectType:h,selectItem:f,playAllSongs:a}},components:{SongList:T,Loading:L}},l=t=>(V("data-v-37ddd36a"),t=t(),B(),t),P={class:"rank"},U={class:"rank-container"},z={class:"rank-main"},H={class:"cover"},j={class:"cover-img"},K=l(()=>s("div",{slot:"placeholder",class:"image-slot"},[s("i",{class:"iconfont icon-placeholder"})],-1)),Q={class:"cover-info"},W={class:"cover-header"},X={class:"cover-title"},Y={class:"cover-author-tags"},G={key:0,class:"cover-author"},J=l(()=>s("div",{slot:"placeholder",class:"image-slot"},[s("i",{class:"iconfont icon-placeholder"})],-1)),Z={class:"cover-name"},x={class:"cover-date"},ss={class:"cover-digital"},ts={class:"cover-playCount"},os=l(()=>s("i",{class:"iconfont icon-playnum"},null,-1)),es={class:"cover-collect"},ns=l(()=>s("i",{class:"iconfont icon-collect"},null,-1)),as={class:"cover-comment"},is=l(()=>s("i",{class:"iconfont icon-comment"},null,-1)),ls={class:"cover-desc"},rs=l(()=>s("h5",null,"\u6B4C\u5355\u7B80\u4ECB",-1)),cs=["innerHTML"],ds={class:"song-main"},ps={class:"song-header"},_s=l(()=>s("i",{class:"iconfont icon-audio-play"},null,-1)),us={class:"rank-aside"},ms={class:"aside-menu"},vs=l(()=>s("em",null,"TOP\u699C",-1)),hs=[vs],fs=l(()=>s("em",null,"\u7279\u8272\u699C",-1)),ys=[fs],Is=l(()=>s("em",null,"\u573A\u666F\u699C",-1)),gs=[Is],ks={class:"type-main"},Ts=["onClick"],Ls={class:"item-info"},Cs={class:"item-title"},Ss={class:"item-time"},$s=l(()=>s("div",{slot:"placeholder",class:"image-slot"},[s("i",{class:"iconfont icon-placeholder"})],-1));function bs(t,n,v,r,o,g){const u=O,h=L,f=T;return _(),m("div",P,[s("div",U,[s("div",z,[s("div",H,[s("div",j,[y(u,{src:t.rankInfo.coverImgUrl},{default:I(()=>[K]),_:1},8,["src"])]),s("div",Q,[s("div",W,[s("div",X,[d(i(t.rankInfo.name)+" ",1),s("span",null,"("+i(t.$utils.formartDate(t.rankInfo.updateTime,"MM\u6708dd\u65E5"))+" \u66F4\u65B0)",1)])]),s("div",Y,[t.rankInfo.creator?(_(),m("div",G,[y(u,{src:t.rankInfo.creator.avatarUrl,class:"cover-avatar"},{default:I(()=>[J]),_:1},8,["src"]),s("div",Z,i(t.rankInfo.creator.nickname),1),s("div",x,i(t.$utils.formartDate(t.rankInfo.createTime,"yyyy-MM-dd")),1)])):q("",!0)]),s("div",ss,[s("span",ts,[os,d(" "+i(t.$utils.formartNum(t.rankInfo.playCount))+"\u6B21",1)]),s("span",es,[ns,d(" "+i(t.$utils.formartNum(t.rankInfo.subscribedCount)),1)]),s("span",as,[is,d(" "+i(t.$utils.formartNum(t.rankInfo.commentCount)),1)])]),s("div",ls,[rs,s("p",{innerHTML:t.rankInfo.description},null,8,cs)])])]),s("div",ds,[s("div",ps,[s("h4",null,[d("\u6B4C\u66F2\u5217\u8868 "),s("em",null,i(t.total+"\u9996\u6B4C"),1)]),s("span",{class:"play-all",onClick:n[0]||(n[0]=(...a)=>r.playAllSongs&&r.playAllSongs(...a))},[_s,d(" \u64AD\u653E\u5168\u90E8")]),s("span",{class:p(["collect",t.rankInfo.subscribed?"active":""]),onClick:n[1]||(n[1]=a=>t.subPlayList(t.rankInfo))},[s("i",{class:p(["iconfont","icon-collect"+(t.rankInfo.subscribed?"-active":"")])},null,2),d(" "+i(t.rankInfo.subscribed?"\u5DF2\u6536\u85CF":"\u6536\u85CF"),1)],2)]),t.isLoading?(_(),k(h,{key:0})):(_(),k(f,{key:1,songList:t.songList,stripe:!0},null,8,["songList"]))])]),s("div",us,[s("div",ms,[s("span",{class:p(t.type==="Top"?"active":""),onClick:n[2]||(n[2]=a=>r.selectType("Top"))},hs,2),s("span",{class:p(t.type==="Feature"?"active":""),onClick:n[3]||(n[3]=a=>r.selectType("Feature"))},ys,2),s("span",{class:p(t.type==="Other"?"active":""),onClick:n[4]||(n[4]=a=>r.selectType("Other"))},gs,2)]),s("div",ks,[(_(!0),m(w,null,A(t.list,(a,e)=>(_(),m("div",{class:p(["type-item",t.rId==a.id?"active":""]),key:e,onClick:c=>r.selectItem(a)},[s("div",Ls,[s("div",Cs,i(a.name),1),s("div",Ss,i(a.updateFrequency),1)]),y(u,{class:"item-img",src:a.coverImgUrl},{default:I(()=>[$s]),_:2},1032,["src"])],10,Ts))),128))])])])])}var Ms=C(E,[["render",bs],["__scopeId","data-v-37ddd36a"]]);export{Ms as default};
