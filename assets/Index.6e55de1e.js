import{Q as S,a2 as V,R as $,r as B,e as E,o as M,w as C,I as P,a5 as R,k as n,l as o,F as T,C as b,X as L,D as m,z as w,t as u,s as D,x as I,m as j,j as r,q as x,K as z,U as F,V as K}from"./index.c94220ca.js";import{E as Q}from"./el-infinite-scroll.43d4b37a.js";import{_ as q}from"./Loading.15072aef.js";import{_ as N}from"./PlayList.8792bb87.js";import"./throttle.2c770a80.js";import"./el-skeleton-item.4d378480.js";const U={name:"PlayListWrap",setup(){const{proxy:s}=z(),c=V(),y=$(),l=c.query.cat,t=B({sub:[],categories:[],curType:"\u5168\u90E8\u6B4C\u5355",moreTxt:{},allList:{name:"\u5168\u90E8\u6B4C\u5355"},playlist_list:[],playlist_count:24,playlist_loading:!0,busy:!0,params:{order:"hot",cat:l,limit:48,offset:0}}),f=async()=>{const{data:e}=await s.$http.catlist();if(t.sub=e.sub,e.code!==200)return s.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");for(const a in e.categories){const d={name:e.categories[a]};d.children=t.sub.filter(k=>k.category===Number(a)),t.categories.push(d)}t.curType=l||e.all.name,t.allList=e.all,_()},_=()=>{const e=t.sub.find(a=>a.name===t.curType);t.moreTxt={},e&&t.categories[e.category].children.indexOf(e)>=8&&(t.moreTxt[e.category]=e)};E(()=>()=>["item-box","filter-more",moreTxt[index]?"active":""]);const h=e=>{y.push({path:"playlist",query:{cat:e.name,order:t.params.order}})},g=()=>{y.push({path:"playlist"})},v=e=>{y.push({path:"playlist",query:{cat:t.params.cat,order:e}})},i=async e=>{const{data:a}=await s.$http.playList(e);if(a.code!==200)return s.$msg.error("\u6570\u636E\u8BF7\u6C42\u5931\u8D25");t.playlist_list=t.params.offset!==0?[...t.playlist_list,...a.playlists]:a.playlists,t.busy=t.playlist_list.length>=a.total,t.playlist_loading=!1},p=()=>{t.busy=!0,t.params.offset=t.playlist_list.length};return M(()=>{f(),i(t.params)}),C(()=>c.query,(e,a)=>{const{cat:d,order:k}=e;t.curType=d||t.allList.name,t.params=Object.assign({},{order:"hot",cat:"",limit:50,offset:0},{cat:d||"",order:k||"hot"}),_()}),C(()=>t.params,(e,a)=>{e.cat!==a.cat&&(t.busy=!0,t.playlist_list=[]),i(e)},{deep:!0}),{...P(t),getCatlist:f,selectType:h,closed:g,loadMore:p,selectOrder:v}},components:{PlayList:N,Loading:q}},O=s=>(F("data-v-a4582662"),s=s(),K(),s),W={class:"playlist"},X={class:"filter"},A={class:"filter-title"},G={class:"filter-box"},H=["onClick"],J=O(()=>o("i",{class:"iconfont icon-arrow"},null,-1)),Y={key:1},Z={class:"filter-drop"},ee=["onClick"],te={class:"list-container"},se={class:"list-head"},ae=O(()=>o("i",{class:"iconfont icon-closed"},null,-1)),oe=[ae],re={class:"type"},le={class:"wrapper infinite-list","infinite-scroll-disabled":"busy","infinite-scroll-distance":"100"};function ie(s,c,y,l,t,f){const _=R,h=N,g=q,v=Q;return r(),n("div",W,[o("div",X,[(r(!0),n(T,null,b(s.categories,(i,p)=>(r(),n("div",{class:"filter-item",key:p},[o("div",A,m(i.name),1),o("div",G,[(r(!0),n(T,null,b(i.children.slice(0,8),e=>(r(),n("span",{class:u(["item-box",s.curType===e.name?"active":""]),key:e.name},[o("em",{onClick:a=>l.selectType(e)},m(e.name),9,H)],2))),128)),I(_,{width:"auto",trigger:"click"},{reference:x(()=>[i.children.length>9?(r(),n("span",{key:0,class:u(["item-box","filter-more",s.moreTxt[p]?"active":""])},[o("em",null,[L(m(s.moreTxt[p]?s.curType:"\u66F4\u591A"),1),J])],2)):(r(),n("span",Y))]),default:x(()=>[o("div",Z,[(r(!0),n(T,null,b(i.children.slice(9),e=>(r(),n("span",{class:u(["item-box",s.curType===e.name?"active":""]),key:e.name},[o("em",{onClick:a=>l.selectType(e,p)},m(e.name),9,ee)],2))),128))])]),_:2},1024)])]))),128))]),o("div",te,[o("div",se,[o("h2",null,[L(m(s.curType)+" ",1),s.curType!==s.allList.name?(r(),n("em",{key:0,class:"filter-close",onClick:c[0]||(c[0]=(...i)=>l.closed&&l.closed(...i))},oe)):w("",!0)]),o("div",re,[o("span",{class:u(s.params.order==="hot"?"active":""),onClick:c[1]||(c[1]=i=>l.selectOrder("hot"))},"\u70ED\u95E8",2),o("span",{class:u(s.params.order==="new"?"active":""),onClick:c[2]||(c[2]=i=>l.selectOrder("new"))},"\u6700\u65B0",2)])]),D((r(),n("div",le,[I(h,{playList:s.playlist_list,loading:s.playlist_loading,num:s.playlist_count},null,8,["playList","loading","num"]),s.busy?(r(),j(g,{key:0})):w("",!0)])),[[v,l.loadMore]])])])}var ye=S(U,[["render",ie],["__scopeId","data-v-a4582662"]]);export{ye as default};
